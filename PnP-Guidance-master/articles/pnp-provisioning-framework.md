
# PnP 设置框架
获取适用于 Office 365 和 SharePoint Online 网站集的远程设置功能的高级概述，并了解不再推荐创建沙盒和完全信任的解决方案的原因。

 **上次修改时间：** 2015年10月15日


 **注释**  名称"SharePoint 相关应用程序"将更改为"SharePoint 外接程序"。在转换期间，某些 SharePoint 产品和 Visual Studio 工具的文档和 UI 仍可能使用术语"SharePoint 相关应用程序"。有关详细信息，请参阅 [Office 和 SharePoint 相关应用程序的新名称](05b07b04-6c8b-4b7e-bd86-e32c589dfead.md#bk_newname)。


 针对配置您的网站集提供了以代码为中心的基于模板的平台。新的设置引擎允许您保留和重复使用 Office 365 和 SharePoint Online 以及本地网站集中的设置模型。


## 为什么使用新方法？

这回避了以下问题： _为什么需要采用新方法？_ _与使用沙盒和完全信任的解决方案相比，此方法有何优势？_

第一个问题的答案涉及对 SharePoint 外接程序和外接程序模型（以前称为"应用程序模型"）的引入。进行此更改后，Microsoft 从沙盒解决方案和完全信任解决方案中分离出来，以支持提供程序托管的外接程序和本地解决方案。这些创新推动了设置模型的重组，并引入了新的设置引擎。

第二个问题 _新的设置模型有哪些优点？_ 有以下几个答案：


- 自定义模板。由于网站集总是首先使用现成的模板，您使用新的远程设置模型引入的自定义设置将包含自动更新，而无需您进一步维护。此外，此方法可避免由在不同的网站集使用不同模板导致的问题。
    
- 使用基于模板的模型。提供简单的、基于模板的设置模型，让您可以将现有网站设计另存为设置模板。 
    
- 使用不同的方法定义模板。或者，您可以在验证 [PnP 设置架构](pnp-provisioning-schema.md)的 XML 中手动定义模板，或者使用托管代码来定义模版，以构造对象层次结构。此外，您可以结合使用这些方法。
    
- 序列化和重复使用模板。您可以序列化并重复使用您的设置模板。
    
- 采用序列化的格式保留模板。您可以采用最适用的任何序列化格式（例如，XML 或 JSON）保留您的设置模板。
    
- 设置新的网站集。您可以采用所选的任何序列化格式将设置模板应用到目标网站，从而轻松地设置新网站集。
    
- 与客户端对象模型集成。客户端对象模型 (CSOM) 的集成通过启用自动化的基于代码的设置为您提供了极高的灵活性。您可以使用 CSOM/REST 代码或 Windows PowerShell 脚本借助设置模版来设置新网站集。
    
- 使用增量设置。您可以将设置模板应用到除现有网站的其他网站。设置引擎支持增量设置，因此，将基于在模板定义中提供的任何作用域添加/更新网站。
    
- 扩展设置引擎。通过使用自定义扩展性提供程序（允许您执行您使用 CSOM/REST 托管代码编写的自定义逻辑），可以轻松实现扩展设置引擎。
    
- 跨本地环境和 Office 365 部署运行。设置引擎现在可以实现跨本地环境和 Office 365 部署无缝运行。这是对以前的设置技术的一大改进，以前自定义网站定义在 Office 365 中不受支持，因为这些定义需要进行服务器场范围的部署。
    

## 远程设置概述

本节中，我们深入探究远程设置的每个部分。对于首先查看整体情况并掌握格式最简单的远程设置而言，这可能很有用。如果从这个角度来看，远程设置仅涉及三大要素：


1. 设计并创建网站的自定义项。
    
2. 创建并选择性地采用所选的序列化格式保留设置模板。
    
3. 将设置模板应用到使用现成的网站模板创建的新的或现有的网站集。
    

### 1. 构建网站和网站项目模型

第一步是创建要保存并应用到网站集的网站自定义项。可使用多种方法执行此操作。最简单的方法就是对现有的网站页面做出所需修改，然后将该页面另存为设置模板。有关详细信息，请参阅 [Provisioning templates](http://msdn.microsoft.com/library/b3eeb7e7-37cf-4e70-8486-34f67220fe33%28Office.15%29.aspx)。

您还可以将设置模板手动创建为 XML 文件，或通过使用托管代码 (CSOM/REST) 创建对象的层次结构，用以表示网站项目和结构。如果您要创建架构文件，则必须针对设置 XSD 架构验证该文件（请参阅 [PnP 设置架构](pnp-provisioning-schema.md)）。

有关构建网站模型的详细信息，请参阅 [PnP 设置引擎和核心库](pnp-provisioning-engine-and-the-core-library.md)文章。


### 2. 导出并保留设置模板

以您首选的序列化格式导出自定义网站模型；相对于持久性格式，设置引擎具有不可知性。这个已保存的自定义项的实例就是您的设置模板，您可以轻松地应用于新网站集。请注意，序列化和保留模板是可选步骤，只有当您想要保留该模板时，才作为必要步骤。若要将模版应用到新网站集，则无需序列化模板。


### 3. 将设置模板应用到新网站集

您可以使用 Windows PowerShell 脚本或 CSOM/REST 代码将设置模板应用到新的或现有的网站集。还可以设置整个网站集或仅设置网站集的一部分。若要查看正在运行的远程设置的示例，包括将设置模板序列化为 XML，请参阅 [设置控制台应用程序示例](provisioning-console-application-sample.md)。


## 其他资源



- [PnP 远程设置](pnp-remote-provisioning.md)
    
- [设置控制台应用程序示例](provisioning-console-application-sample.md)
    
- [PnP 设置引擎和核心库](pnp-provisioning-engine-and-the-core-library.md)
    
- [PnP 设置架构](pnp-provisioning-schema.md)
    
